import{_ as f,i as g,n as v,r as o,o as u,c as $,w as a,a as r,b as l,d as n,e as b,t as _,f as D,p as k,g as y}from"./index.js";const S={components:{inputForm:g,navigationToolbar:v},computed:{counts:function(){return this.$store.getters["diver/counts"]},inputForms:function(){return this.$store.getters["diver/inputForms"]}},created:function(){const t=this.$store.getters["env/data"];this.inputForms.forEach(e=>{e.inputItems.forEach(s=>{switch(s.key){case"email":s.value=t.email;break;case"email_confirmation":s.value=t.email;break}})})},data(){return{inputData:null,token:null,topMessage:null}},methods:{confirm:function(){var e,s;let t=null;if(!t&&((e=this.counts)==null?void 0:e.max)<=((s=this.counts)==null?void 0:s.current)&&(t="1日の検索回数が上限に達しました"),!t&&!this.inputData&&(t="入力エラーがあります<br>確認してください"),t){this.$ons.notification.confirm({title:"確認",message:t,buttonLabels:["はい"]});return}this.submit()},onGetData:function(t){this.inputData=t==null?void 0:t.inputData},submit:async function(){var t;this.$emit("show-loading-navigation");try{const e=await this.$store.dispatch("diver/index",this.inputData);if(e.success){const s=this.$store.getters["diver/divers"];Array.isArray(s)&&s.length>0&&((t=s[0])!=null&&t.id)&&this.token?(this.$emitter.emit("diver:selected:".concat(this.token),s[0]),this.$emit("pop-page-navigation")):this.$ons.notification.alert({title:"エラー",message:"該当するダイバーIDが存在しません"})}else this.$ons.notification.alert({title:"エラー",message:e.message})}catch(e){this.$logger.error("[".concat(this.$options.name,"/submit] ").concat(e)),this.$ons.notification.alert({title:"エラー",message:e.message})}finally{this.$emit("hide-loading-navigation")}}},mounted:function(){const t=this.$emitter&&this.$emitter._pendingTokens?this.$emitter._pendingTokens:[];if(t.length>0&&(this.token=t.pop()),this.$emitter){const e=this.$emitter._lastNavigationSource;e&&(e==="MyPage"&&(this.topMessage="アプリユーザー情報を表示しています。"),delete this.$emitter._lastNavigationSource)}},name:"DiverSearchPage"},x=t=>(k("data-v-d01e87ed"),t=t(),y(),t),I={id:"content__header"},F=x(()=>n("p",{class:"note--center"},"アプリと連携するダイバーIDを検索します。",-1)),w={key:0,class:"note--center"},N={id:"content__body"},C={class:"input-area"},M={id:"content__footer"},P={class:"note--center"};function B(t,e,s,G,c,i){const d=o("navigation-toolbar"),h=o("input-form"),m=o("v-ons-button"),p=o("v-ons-page");return u(),$(p,null,{default:a(()=>[r(d,{"back-label":"戻る"},{default:a(()=>[l("ダイバーID検索")]),_:1}),n("div",I,[F,c.topMessage?(u(),b("p",w,_(c.topMessage),1)):D("v-if",!0)]),n("div",N,[n("div",C,[r(h,{inputForms:i.inputForms,onGetData:i.onGetData},null,8,["inputForms","onGetData"])])]),n("div",M,[n("p",P," 本日はあと"+_(this.counts.max-this.counts.current)+"回検索可能です。 ",1),r(m,{onClick:i.confirm,class:"button"},{default:a(()=>[l("ダイバーIDを検索する")]),_:1},8,["onClick"])])]),_:1})}const V=f(S,[["render",B],["__scopeId","data-v-d01e87ed"],["__file","/Users/koichifukuda/Documents/bsac/bsac-member-ccard-vue3/src/components/DiverSearchPage.vue"]]);export{V as default};
